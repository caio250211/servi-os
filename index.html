<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Insect Control TupÃ­ - Dashboard</title>

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
/* ===== TEMA ===== */
:root {
    --primary:#cc0000;
    --primary-hover:#aa0000;
    --bg:#1e2125;
    --card:#272b30;
    --text:#e0e0e0;
    --muted:#a0a0a0;
    --success:#66bb6a;
    --info:#29b6f6;
    --danger:#d32f2f;
}
body{margin:0;font-family:Roboto;background:var(--bg);color:var(--text)}
.dashboard{display:grid;grid-template-columns:260px 1fr;min-height:100vh}
.sidebar{background:var(--primary);padding:25px;color:#fff}
.sidebar h2{text-align:center}
.nav{margin-top:40px}
.nav div{padding:12px;border-radius:6px;cursor:pointer}
.nav div:hover,.nav .active{background:var(--primary-hover)}
.main{padding:30px}
.card{background:var(--card);padding:20px;border-radius:6px}
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;margin-bottom:30px}
table{width:100%;border-collapse:collapse}
th,td{padding:12px;border-bottom:1px solid #444}
.status{padding:4px 10px;border-radius:20px;font-size:12px;cursor:pointer}
.pago{background:#2e7d32}
.pendente{background:#8d6e63}
.btn{background:var(--success);border:none;padding:10px;border-radius:5px;cursor:pointer}
.btn-del{background:var(--danger)}
.hidden{display:none}
</style>
</head>

<body>

<div class="dashboard" id="app" style="display:none">

<!-- SIDEBAR -->
<div class="sidebar">
    <h2>Insect TupÃ­</h2>

    <div class="nav">
        <div class="nav-link active" data-view="geral">ðŸ“‹ ServiÃ§os</div>
        <div class="nav-link" data-view="2026">ðŸ“… ServiÃ§os 2026</div>
        <div class="nav-link" data-view="resumo">ðŸ“Š Resumo</div>
        <div onclick="logout()">ðŸšª Sair</div>
    </div>
</div>

<!-- MAIN -->
<div class="main">

<!-- SERVIÃ‡OS GERAL -->
<div id="view-geral">
    <h1>ServiÃ§os (Todos)</h1>

    <div class="cards">
        <div class="card">Total: <span id="g-total">0</span></div>
        <div class="card">Valor: <span id="g-valor">R$0</span></div>
    </div>

    <table>
        <thead>
        <tr>
            <th>Data</th><th>Cliente</th><th>Valor</th><th>Status</th><th></th>
        </tr>
        </thead>
        <tbody id="lista-geral"></tbody>
    </table>
</div>

<!-- SERVIÃ‡OS 2026 -->
<div id="view-2026" class="hidden">
    <h1>ServiÃ§os de 2026</h1>

    <div class="cards">
        <div class="card">Total 2026: <span id="y-total">0</span></div>
        <div class="card">Valor 2026: <span id="y-valor">R$0</span></div>
    </div>

    <table>
        <thead>
        <tr>
            <th>Data</th><th>Cliente</th><th>Valor</th><th>Status</th><th></th>
        </tr>
        </thead>
        <tbody id="lista-2026"></tbody>
    </table>
</div>

<!-- RESUMO -->
<div id="view-resumo" class="hidden">
    <h1>Resumo Financeiro</h1>
    <div class="card">Total Pago: <span id="r-pago">R$0</span></div>
</div>

</div>
</div>

<!-- LOGIN SIMPLES -->
<div id="login">
    <input id="email" placeholder="Email"><br><br>
    <input id="senha" type="password" placeholder="Senha"><br><br>
    <button onclick="login()">Entrar</button>
</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
import { getFirestore, collection, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

const app = initializeApp({
    apiKey: "SUA_KEY",
    authDomain: "SEU_DOMINIO",
    projectId: "SEU_PROJECT"
});

const auth = getAuth(app);
const db = getFirestore(app);

let servicos=[];

/* AUTH */
window.login=()=>signInWithEmailAndPassword(auth,email.value,senha.value);
window.logout=()=>signOut(auth);

/* LOAD */
async function carregar(){
    const snap = await getDocs(collection(db,"servicos"));
    servicos = snap.docs.map(d=>({id:d.id,...d.data()}));
    render();
}

/* RENDER */
function render(){
    const geral = servicos;
    const y2026 = servicos.filter(s=>s.data.startsWith("2026"));

    document.getElementById("g-total").innerText = geral.length;
    document.getElementById("y-total").innerText = y2026.length;

    document.getElementById("lista-geral").innerHTML =
        geral.map(linha).join("");

    document.getElementById("lista-2026").innerHTML =
        y2026.map(linha).join("");
}

function linha(s){
    return `<tr>
        <td>${s.data}</td>
        <td>${s.cliente}</td>
        <td>R$ ${s.valor}</td>
        <td><span class="status ${s.status==='Pago'?'pago':'pendente'}">${s.status}</span></td>
        <td><button class="btn-del" onclick="del('${s.id}')">X</button></td>
    </tr>`;
}

window.del=async id=>{
    await deleteDoc(doc(db,"servicos",id));
    carregar();
};

/* NAV */
document.querySelectorAll(".nav-link").forEach(b=>{
    b.onclick=()=>{
        document.querySelectorAll(".nav-link").forEach(x=>x.classList.remove("active"));
        b.classList.add("active");

        ["geral","2026","resumo"].forEach(v=>{
            document.getElementById("view-"+v).classList.add("hidden");
        });
        document.getElementById("view-"+b.dataset.view).classList.remove("hidden");
    }
});

/* INIT */
onAuthStateChanged(auth,u=>{
    if(u){
        login.style.display="none";
        app.style.display="grid";
        carregar();
    }
});
</script>

</body>
</html>


